<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head}">
</head>

<body>
<div class="wrapper">
    <header>
        <nav th:replace="~{fragments/navbar}" class="main-nav"></nav>
    </header>

    <!-- Input for Route ID -->
    <input type="hidden" name="routeId" id="routeId">

    <!-- Details Section -->
    <div class="details-main">

        <section class="route-info text-center" style="display: flex; flex-direction: column; align-items: center;">
            <h4 th:text="${route.name}" id="track-name"></h4>
            <p style="font-size: 18px; font-weight: bold;">Total distance: <span id="totalDistance" style="font-weight: normal"></span> km</p>
            <p style="font-size: 18px; font-weight: bold;">Author name: <span th:text="${route.author.fullName}" style="font-weight: normal" id="authorName"></span></p>

            <div style="margin-top: 20px;">
                <span style="font-size: 18px; font-weight: bold; color: black;">Difficulty Level:</span>
                <p th:text="${route.level}" style="margin-top: 5px; font-size: 18px;"></p>
                <img class="level-img" src="/images/difficulty-level.png" alt="" style="margin-top: 10px;">
            </div>

            <div style="margin-top: 20px;">
                <span style="color: black; font-weight: bold;">GPX Download:</span>
                <a id="showGPX" style="color: white; margin-left: 10px;">Show GPX</a>
            </div>

            <div id="gpxContent" style="display: none; margin-top: 10px;">
                <label for="gpxCoordinates">GPX Coordinates:</label>
                <textarea id="gpxCoordinates" name="gpxCoordinates" style="width: 100%; height: 100px;" th:text="${route.gpxCoordinates}" readonly></textarea>
            </div>
        </section>


        <section id="map">

        </section>

        <section id="video">
            <iframe width="560" height="315" th:src="@{'https://www.youtube.com/embed/' + ${route.videoUrl}}" frameborder="1" alt="no video attached" allowfullscreen="0"></iframe>
        </section>

        <section class="route-description text-center">
            <h4>Description:</h4>
            <p th:text="${route.description}" id="route-description"></p>
        </section>

        <section class="gallery">

        </section>

        <section class="comments">
            <h1>Comments</h1>

            <!-- Comments submission -->
            <form id="commentForm" method="POST" action="/">
                <div class="form-group">
                    <h4>Leave a comment</h4>
                    <label for="message">Message</label>
                    <textarea name="message" id="message" cols="30" rows="5" class="form-control"
                              style="background-color: white;"></textarea>
                    <small id="messageError" class="invalid-feedback">Message should be at least 10
                        characters.</small>
                </div>

                <div class="form-group">
                    <input type="submit" class="btn" id="postComment" value="Post Comment" />
                </div>
            </form>
            <!-- Comments submission -->

            <!-- All comments section -->
            <div>
                <span id="commentCtnr"><!-- Comments section, filled in by script --></span>
            </div>
            <!-- EO: All comments section -->
        </section>
    </div>
</div>

<footer class="footer bg-blur rounded">
    <div class="container-fluid text-center">
        <div class="h5 text-white">&copy; Hristo Baldzhiyski Pathfinder Project 2024. All rights reserved.</div>
    </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
<script>
    $(document).ready(function() {
        $("#showGPX").click(function(e) {
            e.preventDefault();
            var gpxCoordinates = $("#gpxCoordinates").val();
            var filename = "route.gpx";
            var blob = new Blob([gpxCoordinates], { type: "text/plain;charset=utf-8" });
            saveAs(blob, filename);
        });
    });
</script>
</body>

</html>
